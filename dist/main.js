(()=>{"use strict";const e=[];class t{constructor(e){this.title=e,this.tasks=[]}removeProject(){e.splice(e.indexOf(this),1)}addTask(e){this.tasks.push(e)}removeTask(e){this.tasks.splice(this.tasks.indexOf(e),1)}}class n{constructor(e,t,n,s,d){this.title=e,this.desc=t,this.duedate=n,this.priority=s,this.complete=d}}let s=!1,d=document.getElementById("project-header");const a=document.getElementById("task-form-container"),c=document.getElementById("task-form");function o(n){l();const s=document.createElement("div"),a=document.createElement("p"),c=document.createElement("span"),o=document.createElement("span");for(d.innerText=n,s.classList.add("project"),s.setAttribute("data-project-index",e.length),a.classList.add("mouse-effect"),a.innerText=n,c.classList.add("icon","edit-icon"),o.classList.add("icon","delete-icon"),document.getElementById("add-project-btn").disabled=!1,a.addEventListener("click",(()=>{d.innerText=n;let t=s.dataset.projectIndex;document.getElementById("task-form").dataset.projectIndex=t,l();for(let n of r.tasks)i(n.title,n.desc,n.duedate,n.priority,n.complete,t,e[t].tasks.indexOf(n))})),o.addEventListener("click",(()=>{let t=s.dataset.projectIndex;if(function(t,n){let s=t.dataset.projectIndex;t.remove(),n.removeProject(),s>0?(document.getElementById("task-form").dataset.projectIndex=s-1,d.innerText=e[s-1].title):d.innerText="";const a=document.querySelectorAll(`div.task[data-project-index="${s}"]`);for(let e of a)e.remove();const c=document.querySelectorAll(".project");for(let t in e)c[t].setAttribute("data-project-index",t)}(s,r),t>0)for(let s of e[t-1].tasks)i(s.title,s.desc,s.duedate,s.priority,s.complete,t-1,n)}));s.hasChildNodes();)s.removeChild(s.lastChild);document.getElementById("task-container").appendChild(d),document.getElementById("projects-container").appendChild(s),s.append(a,c,o),document.getElementById("task-form").dataset.projectIndex=s.dataset.projectIndex,document.getElementById("project-form").reset(),document.getElementById("project-form-container").style.display="none";const r=function(n){const s=new t(n);return e.push(s),s}(a.innerText)}function i(e,t,n,d,o,i,l){const u=document.createElement("div"),p=document.createElement("span"),k=document.createElement("label"),x=document.createElement("input"),E=document.createElement("p"),L=document.createElement("p"),y=document.createElement("p"),v=document.createElement("p"),f=document.createElement("span"),g=document.createElement("span");u.classList.add("task"),u.setAttribute("data-project-index",i),u.setAttribute("data-task-index",l),x.type="checkbox",x.classList.add("checkbox"),!0===o?(k.innerText="Complete",x.checked=!0):k.innerText="Unfinished",p.classList.add("expand"),x.type="checkbox",x.classList.add("checkbox"),E.innerText=e,L.classList.add("desc"),L.innerText=t,y.innerText=n,v.innerText=d,f.classList.add("icon","edit-icon"),g.classList.add("icon","delete-icon"),p.addEventListener("click",(()=>{p.classList.contains("rotate-up")?(p.classList.remove("rotate-up"),p.classList.add("rotate-down"),u.classList.add("task-expand"),u.classList.remove("task-reduce"),L.classList.add("desc-expand")):p.classList.contains("rotate-down")?(p.classList.remove("rotate-down"),p.classList.add("rotate-up"),u.classList.remove("task-expand"),u.classList.add("task-reduce"),L.classList.remove("desc-expand")):(p.classList.add("rotate-down"),u.classList.add("task-expand"),L.classList.add("desc-expand"))})),f.addEventListener("click",(()=>{s=!0,a.style.display="block",c.dataset.taskIndex=l,r(E.innerText,L.innerText,y.innerText,v.innerText)})),g.addEventListener("click",(()=>{m(u,task)})),document.getElementById("task-container").appendChild(u),u.append(p,x,k,E,L,y,v,f,g)}function l(){const e=document.getElementById("task-container");for(;e.hasChildNodes()&&e.childElementCount>1;)e.removeChild(e.lastChild)}function r(e,t,n,s){document.getElementById("title").value=e,document.getElementById("desc").value=t,document.getElementById("due-date").value=n,document.getElementById("priority").value=s}function m(t,n){let s=t.dataset.projectIndex;t.remove(),e[s].removeTask(n);const d=document.querySelectorAll(".task");for(let t in e[s].tasks)d[t].dataset.taskIndex=t}o("Default");const u=document.getElementById("add-project-btn"),p=document.getElementById("add-task-btn"),k=document.getElementById("task-form");document.getElementById("project-form").addEventListener("submit",(e=>{e.preventDefault(),o(e.target[0].value)})),u.addEventListener("click",(()=>{document.getElementById("project-form-container").style.display="block"})),k.addEventListener("submit",(t=>{t.preventDefault(),!1===s?function(t){const d=document.createElement("div"),o=document.createElement("span"),i=document.createElement("label"),l=document.createElement("input"),u=document.createElement("p"),p=document.createElement("p"),k=document.createElement("p"),x=document.createElement("p"),E=document.createElement("span"),L=document.createElement("span");let y=e[t].tasks.length,v=document.getElementById("title").value,f=document.getElementById("desc").value,g=document.getElementById("due-date").value,I=document.getElementById("priority").value;d.classList.add("task"),d.setAttribute("data-project-index",t),d.setAttribute("data-task-index",y),o.classList.add("expand"),i.innerText="Unfinished",l.type="checkbox",l.classList.add("checkbox"),u.innerText=v,p.classList.add("desc"),p.innerText=f,k.innerText=g,x.innerText=I;let h=function(e){switch(e){case 1:return"red";case 2:return"orange";case 3:return"green";case 4:return"blue"}}(Number(I));x.style.backgroundColor=h,E.classList.add("icon","edit-icon"),L.classList.add("icon","delete-icon"),o.addEventListener("click",(()=>{o.classList.contains("rotate-up")?(o.classList.remove("rotate-up"),o.classList.add("rotate-down"),d.classList.add("task-expand"),d.classList.remove("task-reduce"),p.classList.add("desc-expand")):o.classList.contains("rotate-down")?(o.classList.remove("rotate-down"),o.classList.add("rotate-up"),d.classList.remove("task-expand"),d.classList.add("task-reduce"),p.classList.remove("desc-expand")):(o.classList.add("rotate-down"),d.classList.add("task-expand"),p.classList.add("desc-expand"))})),l.addEventListener("click",(()=>{!1===T.complete?(T.complete=!0,i.innerText="Complete",d.classList.add("complete")):(T.complete=!1,i.innerText="Unfinished",d.classList.remove("complete"))})),E.addEventListener("click",(()=>{console.log(e[t].tasks.indexOf(T)),console.log(e),s=!0,a.style.display="block",c.dataset.taskIndex=e[t].tasks.indexOf(T),r(u.innerText,p.innerText,k.innerText,x.innerText)})),L.addEventListener("click",(()=>{m(d,T)})),document.getElementById("task-container").appendChild(d),d.append(o,l,i,u,p,k,x,E,L),document.getElementById("task-form").reset(),document.getElementById("task-form-container").style.display="none";const T=function(t,s,d,a,c,o){const i=new n(t,s,d,a,!1);return e[o].addTask(i),i}(v,f,g,I,0,t)}(t.target.dataset.projectIndex):!0===s&&function(t,n,...d){const o=document.querySelector(`div.task[data-task-index="${n}"]`);console.log(o);const i=o.childNodes;let l=3;for(let s in d)i[l].innerText=d[s],e[t].tasks[n][s]=d[s],l++;c.reset(),a.style.display="none",s=!1}(t.target.dataset.projectIndex,t.target.dataset.taskIndex,t.target[0].value,t.target[1].value,t.target[2].value,t.target[3].value)})),p.addEventListener("click",(()=>{document.querySelectorAll(".project").length>0&&(document.getElementById("task-form-container").style.display="block")}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LElBQ25CaEIsU0FBU0MsZUFBZSx1QkFBdUJtQyxNQUFNQyxRQUFVLFFBQ2pFLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90b2RvLWxpc3QvLi9zcmMvbG9naWMuanMiLCJ3ZWJwYWNrOi8vdG9kby1saXN0Ly4vc3JjL0RPTS5qcyIsIndlYnBhY2s6Ly90b2RvLWxpc3QvLi9zcmMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgYXJyUHJvamVjdHMgPSBbXVxuXG5jbGFzcyBQcm9qZWN0IHtcbiAgY29uc3RydWN0b3IodGl0bGUpIHtcbiAgICB0aGlzLnRpdGxlID0gdGl0bGU7XG4gICAgdGhpcy50YXNrcyA9IFtdO1xuICB9XG4gIHJlbW92ZVByb2plY3QoKSB7XG4gICAgYXJyUHJvamVjdHMuc3BsaWNlKGFyclByb2plY3RzLmluZGV4T2YodGhpcyksIDEpO1xuICB9XG4gIFxuICBhZGRUYXNrKHRhc2spIHtcbiAgICB0aGlzLnRhc2tzLnB1c2godGFzayk7XG4gIH1cblxuICByZW1vdmVUYXNrKHRhc2spIHtcbiAgICB0aGlzLnRhc2tzLnNwbGljZSh0aGlzLnRhc2tzLmluZGV4T2YodGFzayksIDEpO1xuICB9XG59XG5cbmNsYXNzIFRhc2sge1xuICBjb25zdHJ1Y3Rvcih0aXRsZSwgZGVzYywgZHVlZGF0ZSwgcHJpb3JpdHksIGNvbXBsZXRlKSB7XG4gICAgdGhpcy50aXRsZSA9IHRpdGxlO1xuICAgIHRoaXMuZGVzYyA9IGRlc2M7XG4gICAgdGhpcy5kdWVkYXRlID0gZHVlZGF0ZTtcbiAgICB0aGlzLnByaW9yaXR5ID0gcHJpb3JpdHk7XG4gICAgdGhpcy5jb21wbGV0ZSA9IGNvbXBsZXRlO1xuICB9XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZVByb2plY3RDbGFzcyh0aXRsZSkge1xuICBjb25zdCBwcm9qZWN0ID0gbmV3IFByb2plY3QodGl0bGUpO1xuICBhcnJQcm9qZWN0cy5wdXNoKHByb2plY3QpO1xuICByZXR1cm4gcHJvamVjdDtcbn1cblxuZnVuY3Rpb24gY3JlYXRlVGFza0NsYXNzKHRpdGxlLCBkZXNjLCBkdWVkYXRlLCBwcmlvcml0eSwgY29tcGxldGUsIHByb2plY3RJbmRleCkge1xuICBjb25zdCB0YXNrID0gbmV3IFRhc2sodGl0bGUsIGRlc2MsIGR1ZWRhdGUsIHByaW9yaXR5LCBjb21wbGV0ZSk7XG4gIGFyclByb2plY3RzW3Byb2plY3RJbmRleF0uYWRkVGFzayh0YXNrKTtcbiAgcmV0dXJuIHRhc2s7XG59XG5cbmV4cG9ydCB7Y3JlYXRlUHJvamVjdENsYXNzLCBjcmVhdGVUYXNrQ2xhc3MsIGFyclByb2plY3RzfSIsImltcG9ydCB7IGNyZWF0ZVByb2plY3RDbGFzcywgY3JlYXRlVGFza0NsYXNzLCBhcnJQcm9qZWN0cyB9IGZyb20gXCIuL2xvZ2ljLmpzXCI7XG5sZXQgZWRpdCA9IGZhbHNlO1xubGV0IHByb2plY3RIZWFkZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJvamVjdC1oZWFkZXInKTtcbmNvbnN0IHRhc2tGb3JtQ29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Rhc2stZm9ybS1jb250YWluZXInKTtcbmNvbnN0IHRhc2tGb3JtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Rhc2stZm9ybScpO1xuXG5mdW5jdGlvbiBjcmVhdGVQcm9qZWN0KHByb2plY3ROYW1lKSB7XG4gIGNsZWFyVGFzaygpO1xuICBjb25zdCBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgY29uc3QgcCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcbiAgY29uc3QgZWRpdGJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcbiAgY29uc3QgZGVsZXRlQnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuXG4gIHByb2plY3RIZWFkZXIuaW5uZXJUZXh0ID0gcHJvamVjdE5hbWU7XG4gIGRpdi5jbGFzc0xpc3QuYWRkKCdwcm9qZWN0Jyk7XG4gIGRpdi5zZXRBdHRyaWJ1dGUoJ2RhdGEtcHJvamVjdC1pbmRleCcsIGFyclByb2plY3RzLmxlbmd0aCk7XG4gIHAuY2xhc3NMaXN0LmFkZCgnbW91c2UtZWZmZWN0Jyk7XG4gIHAuaW5uZXJUZXh0ID0gcHJvamVjdE5hbWU7XG4gIGVkaXRidG4uY2xhc3NMaXN0LmFkZCgnaWNvbicsICdlZGl0LWljb24nKTtcbiAgZGVsZXRlQnRuLmNsYXNzTGlzdC5hZGQoJ2ljb24nLCAnZGVsZXRlLWljb24nKTtcbiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FkZC1wcm9qZWN0LWJ0bicpLmRpc2FibGVkID0gZmFsc2U7XG5cbiAgcC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICBwcm9qZWN0SGVhZGVyLmlubmVyVGV4dCA9IHByb2plY3ROYW1lO1xuICAgIGxldCBwcm9qZWN0SW5kZXggPSBkaXYuZGF0YXNldC5wcm9qZWN0SW5kZXg7XG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Rhc2stZm9ybScpLmRhdGFzZXQucHJvamVjdEluZGV4ID0gcHJvamVjdEluZGV4O1xuICAgIGNsZWFyVGFzaygpO1xuICAgIGZvcihsZXQgdGFzayBvZiBwcm9qZWN0LnRhc2tzKSB7XG4gICAgICBhcHBlbmRUYXNrKHRhc2sudGl0bGUsIHRhc2suZGVzYywgdGFzay5kdWVkYXRlLCB0YXNrLnByaW9yaXR5LCB0YXNrLmNvbXBsZXRlLCBwcm9qZWN0SW5kZXgsXG4gICAgICAgIGFyclByb2plY3RzW3Byb2plY3RJbmRleF0udGFza3MuaW5kZXhPZih0YXNrKSk7XG4gICAgfVxuICB9KTtcblxuICBkZWxldGVCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgbGV0IHByb2plY3RJbmRleCA9IGRpdi5kYXRhc2V0LnByb2plY3RJbmRleDtcbiAgICBkZWxldGVQcm9qZWN0KGRpdiwgcHJvamVjdCk7XG4gICAgaWYocHJvamVjdEluZGV4ID4gMCkge1xuICAgICAgZm9yKGxldCB0YXNrIG9mIGFyclByb2plY3RzW3Byb2plY3RJbmRleCAtIDFdLnRhc2tzKSB7XG4gICAgICAgIGFwcGVuZFRhc2sodGFzay50aXRsZSwgdGFzay5kZXNjLCB0YXNrLmR1ZWRhdGUsIHRhc2sucHJpb3JpdHksIHRhc2suY29tcGxldGUsIHByb2plY3RJbmRleCAtIDEsIHByb2plY3ROYW1lKTtcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xuXG4gIHdoaWxlKGRpdi5oYXNDaGlsZE5vZGVzKCkpIHtcbiAgICBkaXYucmVtb3ZlQ2hpbGQoZGl2Lmxhc3RDaGlsZCk7XG4gIH1cblxuICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGFzay1jb250YWluZXInKS5hcHBlbmRDaGlsZChwcm9qZWN0SGVhZGVyKTtcbiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Byb2plY3RzLWNvbnRhaW5lcicpLmFwcGVuZENoaWxkKGRpdik7XG4gIGRpdi5hcHBlbmQocCwgZWRpdGJ0biwgZGVsZXRlQnRuKTtcblxuICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGFzay1mb3JtJykuZGF0YXNldC5wcm9qZWN0SW5kZXggPSBkaXYuZGF0YXNldC5wcm9qZWN0SW5kZXg7XG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcm9qZWN0LWZvcm0nKS5yZXNldCgpO1xuICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJvamVjdC1mb3JtLWNvbnRhaW5lcicpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cbiAgY29uc3QgcHJvamVjdCA9IGNyZWF0ZVByb2plY3RDbGFzcyhwLmlubmVyVGV4dCk7XG59XG5cbmZ1bmN0aW9uIGRlbGV0ZVByb2plY3QoZGl2LCBwcm9qZWN0KSB7XG4gIGxldCBpbmRleCA9IGRpdi5kYXRhc2V0LnByb2plY3RJbmRleDtcbiAgZGl2LnJlbW92ZSgpO1xuICBwcm9qZWN0LnJlbW92ZVByb2plY3QoKTtcbiAgaWYoaW5kZXggPiAwKSB7XG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Rhc2stZm9ybScpLmRhdGFzZXQucHJvamVjdEluZGV4ID0gaW5kZXggLSAxO1xuICAgIHByb2plY3RIZWFkZXIuaW5uZXJUZXh0ID0gYXJyUHJvamVjdHNbaW5kZXggLSAxXS50aXRsZTtcbiAgfSBlbHNlIHtcbiAgICBwcm9qZWN0SGVhZGVyLmlubmVyVGV4dCA9IFwiXCI7XG4gIH1cbiAgY29uc3QgcHJvamVjdFRhc2tzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChgZGl2LnRhc2tbZGF0YS1wcm9qZWN0LWluZGV4PVwiJHtpbmRleH1cIl1gKTtcbiAgZm9yKGxldCB0YXNrIG9mIHByb2plY3RUYXNrcykge1xuICAgIHRhc2sucmVtb3ZlKCk7XG4gIH1cbiAgY29uc3QgcHJvamVjdHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucHJvamVjdCcpO1xuICBmb3IobGV0IGkgaW4gYXJyUHJvamVjdHMpIHtcbiAgICBwcm9qZWN0c1tpXS5zZXRBdHRyaWJ1dGUoJ2RhdGEtcHJvamVjdC1pbmRleCcsIGkpO1xuICB9XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZVRhc2socHJvamVjdEluZGV4KSB7XG4gIGNvbnN0IGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICBjb25zdCBleHBhbmRCdG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gIGNvbnN0IGxhYmVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGFiZWwnKTtcbiAgY29uc3QgY2hlY2tib3ggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpO1xuICBjb25zdCBwVGl0bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XG4gIGNvbnN0IHBEZXNjID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xuICBjb25zdCBwRHVlRGF0ZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcbiAgY29uc3QgcFByaW9yaXR5ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xuICBjb25zdCBlZGl0QnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuICBjb25zdCBkZWxldGVCdG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG5cbiAgbGV0IHRhc2tJbmRleCA9IGFyclByb2plY3RzW3Byb2plY3RJbmRleF0udGFza3MubGVuZ3RoO1xuICBsZXQgdGl0bGVWYWx1ZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0aXRsZScpLnZhbHVlO1xuICBsZXQgZGVzY1ZhbHVlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Rlc2MnKS52YWx1ZTtcbiAgbGV0IGR1ZURhdGVWYWx1ZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkdWUtZGF0ZScpLnZhbHVlO1xuICBsZXQgcHJpb3JpdHlWYWx1ZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcmlvcml0eScpLnZhbHVlO1xuXG4gIGRpdi5jbGFzc0xpc3QuYWRkKCd0YXNrJyk7XG4gIGRpdi5zZXRBdHRyaWJ1dGUoJ2RhdGEtcHJvamVjdC1pbmRleCcsIHByb2plY3RJbmRleCk7XG4gIGRpdi5zZXRBdHRyaWJ1dGUoJ2RhdGEtdGFzay1pbmRleCcsIHRhc2tJbmRleCk7XG4gIGV4cGFuZEJ0bi5jbGFzc0xpc3QuYWRkKCdleHBhbmQnKTtcbiAgbGFiZWwuaW5uZXJUZXh0ID0gXCJVbmZpbmlzaGVkXCI7XG4gIGNoZWNrYm94LnR5cGUgPSBcImNoZWNrYm94XCI7XG4gIGNoZWNrYm94LmNsYXNzTGlzdC5hZGQoJ2NoZWNrYm94Jyk7XG4gIHBUaXRsZS5pbm5lclRleHQgPSB0aXRsZVZhbHVlO1xuICBwRGVzYy5jbGFzc0xpc3QuYWRkKCdkZXNjJyk7XG4gIHBEZXNjLmlubmVyVGV4dCA9IGRlc2NWYWx1ZTtcbiAgcER1ZURhdGUuaW5uZXJUZXh0ID0gZHVlRGF0ZVZhbHVlO1xuICBwUHJpb3JpdHkuaW5uZXJUZXh0ID0gcHJpb3JpdHlWYWx1ZTtcbiAgbGV0IGNvbG9yID0gc2V0UHJpb3JpdHlDb2xvcihOdW1iZXIocHJpb3JpdHlWYWx1ZSkpO1xuICBwUHJpb3JpdHkuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gY29sb3I7XG4gIGVkaXRCdG4uY2xhc3NMaXN0LmFkZCgnaWNvbicsICdlZGl0LWljb24nKTtcbiAgZGVsZXRlQnRuLmNsYXNzTGlzdC5hZGQoJ2ljb24nLCAnZGVsZXRlLWljb24nKTtcblxuICBleHBhbmRCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgaWYoZXhwYW5kQnRuLmNsYXNzTGlzdC5jb250YWlucygncm90YXRlLXVwJykpIHtcbiAgICAgIGV4cGFuZEJ0bi5jbGFzc0xpc3QucmVtb3ZlKCdyb3RhdGUtdXAnKTtcbiAgICAgIGV4cGFuZEJ0bi5jbGFzc0xpc3QuYWRkKCdyb3RhdGUtZG93bicpO1xuXG4gICAgICBkaXYuY2xhc3NMaXN0LmFkZCgndGFzay1leHBhbmQnKTtcbiAgICAgIGRpdi5jbGFzc0xpc3QucmVtb3ZlKCd0YXNrLXJlZHVjZScpO1xuXG4gICAgICBwRGVzYy5jbGFzc0xpc3QuYWRkKCdkZXNjLWV4cGFuZCcpO1xuICAgIH0gZWxzZSBpZiAoZXhwYW5kQnRuLmNsYXNzTGlzdC5jb250YWlucygncm90YXRlLWRvd24nKSkge1xuICAgICAgZXhwYW5kQnRuLmNsYXNzTGlzdC5yZW1vdmUoJ3JvdGF0ZS1kb3duJyk7XG4gICAgICBleHBhbmRCdG4uY2xhc3NMaXN0LmFkZCgncm90YXRlLXVwJyk7XG5cbiAgICAgIGRpdi5jbGFzc0xpc3QucmVtb3ZlKCd0YXNrLWV4cGFuZCcpO1xuICAgICAgZGl2LmNsYXNzTGlzdC5hZGQoJ3Rhc2stcmVkdWNlJyk7XG5cbiAgICAgIHBEZXNjLmNsYXNzTGlzdC5yZW1vdmUoJ2Rlc2MtZXhwYW5kJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGV4cGFuZEJ0bi5jbGFzc0xpc3QuYWRkKCdyb3RhdGUtZG93bicpO1xuICAgICAgZGl2LmNsYXNzTGlzdC5hZGQoJ3Rhc2stZXhwYW5kJyk7XG4gICAgICBwRGVzYy5jbGFzc0xpc3QuYWRkKCdkZXNjLWV4cGFuZCcpO1xuICAgIH1cbiAgfSk7XG5cbiAgY2hlY2tib3guYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgaWYodGFzay5jb21wbGV0ZSA9PT0gZmFsc2UpIHtcbiAgICAgIHRhc2suY29tcGxldGUgPSB0cnVlO1xuICAgICAgbGFiZWwuaW5uZXJUZXh0ID0gXCJDb21wbGV0ZVwiO1xuICAgICAgZGl2LmNsYXNzTGlzdC5hZGQoJ2NvbXBsZXRlJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRhc2suY29tcGxldGUgPSBmYWxzZTtcbiAgICAgIGxhYmVsLmlubmVyVGV4dCA9IFwiVW5maW5pc2hlZFwiO1xuICAgICAgZGl2LmNsYXNzTGlzdC5yZW1vdmUoJ2NvbXBsZXRlJyk7XG4gICAgfVxuICB9KTtcblxuICBlZGl0QnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgIGNvbnNvbGUubG9nKGFyclByb2plY3RzW3Byb2plY3RJbmRleF0udGFza3MuaW5kZXhPZih0YXNrKSk7XG4gICAgY29uc29sZS5sb2coYXJyUHJvamVjdHMpO1xuICAgIGVkaXQgPSB0cnVlO1xuICAgIHRhc2tGb3JtQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XG4gICAgdGFza0Zvcm0uZGF0YXNldC50YXNrSW5kZXggPSBhcnJQcm9qZWN0c1twcm9qZWN0SW5kZXhdLnRhc2tzLmluZGV4T2YodGFzayk7XG4gICAgZmlsbEVkaXRGb3JtKHBUaXRsZS5pbm5lclRleHQsIHBEZXNjLmlubmVyVGV4dCwgcER1ZURhdGUuaW5uZXJUZXh0LCBwUHJpb3JpdHkuaW5uZXJUZXh0KTtcbiAgfSk7XG5cbiAgZGVsZXRlQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgIGRlbGV0ZVRhc2soZGl2LCB0YXNrKTtcbiAgfSk7XG5cbiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Rhc2stY29udGFpbmVyJykuYXBwZW5kQ2hpbGQoZGl2KTtcbiAgZGl2LmFwcGVuZChleHBhbmRCdG4sIGNoZWNrYm94LCBsYWJlbCwgcFRpdGxlLCBwRGVzYywgcER1ZURhdGUsIHBQcmlvcml0eSwgZWRpdEJ0biwgZGVsZXRlQnRuKTtcblxuICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGFzay1mb3JtJykucmVzZXQoKTtcbiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Rhc2stZm9ybS1jb250YWluZXInKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXG4gIGNvbnN0IHRhc2sgPSBjcmVhdGVUYXNrQ2xhc3ModGl0bGVWYWx1ZSwgZGVzY1ZhbHVlLCBkdWVEYXRlVmFsdWUsIHByaW9yaXR5VmFsdWUsIGZhbHNlLCBwcm9qZWN0SW5kZXgpO1xufVxuXG5mdW5jdGlvbiBzZXRQcmlvcml0eUNvbG9yKG51bSkge1xuICBzd2l0Y2ggKG51bSkge1xuICAgIGNhc2UgMTpcbiAgICAgIHJldHVybiBcInJlZFwiOztcbiAgICBjYXNlIDI6XG4gICAgICByZXR1cm4gXCJvcmFuZ2VcIjtcbiAgICBjYXNlIDM6XG4gICAgICByZXR1cm4gXCJncmVlblwiO1xuICAgIGNhc2UgNDpcbiAgICAgIHJldHVybiBcImJsdWVcIjtcbiB9XG59XG5cbmZ1bmN0aW9uIGFwcGVuZFRhc2sodGl0bGUsIGRlc2MsIGR1ZWRhdGUsIHByaW9yaXR5LCBjb21wbGV0ZSwgcHJvamVjdEluZGV4LCB0YXNrSW5kZXgpIHtcbiAgY29uc3QgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gIGNvbnN0IGV4cGFuZEJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcbiAgY29uc3QgbGFiZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsYWJlbCcpO1xuICBjb25zdCBjaGVja2JveCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7XG4gIGNvbnN0IHBUaXRsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcbiAgY29uc3QgcERlc2MgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XG4gIGNvbnN0IHBEdWVEYXRlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xuICBjb25zdCBwUHJpb3JpdHkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XG4gIGNvbnN0IGVkaXRCdG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gIGNvbnN0IGRlbGV0ZUJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcblxuICBkaXYuY2xhc3NMaXN0LmFkZCgndGFzaycpO1xuICBkaXYuc2V0QXR0cmlidXRlKCdkYXRhLXByb2plY3QtaW5kZXgnLCBwcm9qZWN0SW5kZXgpO1xuICBkaXYuc2V0QXR0cmlidXRlKCdkYXRhLXRhc2staW5kZXgnLCB0YXNrSW5kZXgpO1xuICBjaGVja2JveC50eXBlID0gXCJjaGVja2JveFwiO1xuICBjaGVja2JveC5jbGFzc0xpc3QuYWRkKCdjaGVja2JveCcpO1xuICBpZihjb21wbGV0ZSA9PT0gdHJ1ZSkge1xuICAgIGxhYmVsLmlubmVyVGV4dCA9IFwiQ29tcGxldGVcIjtcbiAgICBjaGVja2JveC5jaGVja2VkID0gdHJ1ZTtcbiAgfSBlbHNlIHtcbiAgICBsYWJlbC5pbm5lclRleHQgPSBcIlVuZmluaXNoZWRcIjtcbiAgfVxuICBleHBhbmRCdG4uY2xhc3NMaXN0LmFkZCgnZXhwYW5kJyk7XG4gIGNoZWNrYm94LnR5cGUgPSBcImNoZWNrYm94XCI7XG4gIGNoZWNrYm94LmNsYXNzTGlzdC5hZGQoJ2NoZWNrYm94Jyk7XG4gIHBUaXRsZS5pbm5lclRleHQgPSB0aXRsZTtcbiAgcERlc2MuY2xhc3NMaXN0LmFkZCgnZGVzYycpO1xuICBwRGVzYy5pbm5lclRleHQgPSBkZXNjO1xuICBwRHVlRGF0ZS5pbm5lclRleHQgPSBkdWVkYXRlO1xuICBwUHJpb3JpdHkuaW5uZXJUZXh0ID0gcHJpb3JpdHk7XG4gIGVkaXRCdG4uY2xhc3NMaXN0LmFkZCgnaWNvbicsICdlZGl0LWljb24nKTtcbiAgZGVsZXRlQnRuLmNsYXNzTGlzdC5hZGQoJ2ljb24nLCAnZGVsZXRlLWljb24nKTtcblxuICBleHBhbmRCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgaWYoZXhwYW5kQnRuLmNsYXNzTGlzdC5jb250YWlucygncm90YXRlLXVwJykpIHtcbiAgICAgIGV4cGFuZEJ0bi5jbGFzc0xpc3QucmVtb3ZlKCdyb3RhdGUtdXAnKTtcbiAgICAgIGV4cGFuZEJ0bi5jbGFzc0xpc3QuYWRkKCdyb3RhdGUtZG93bicpO1xuXG4gICAgICBkaXYuY2xhc3NMaXN0LmFkZCgndGFzay1leHBhbmQnKTtcbiAgICAgIGRpdi5jbGFzc0xpc3QucmVtb3ZlKCd0YXNrLXJlZHVjZScpO1xuXG4gICAgICBwRGVzYy5jbGFzc0xpc3QuYWRkKCdkZXNjLWV4cGFuZCcpO1xuICAgIH0gZWxzZSBpZiAoZXhwYW5kQnRuLmNsYXNzTGlzdC5jb250YWlucygncm90YXRlLWRvd24nKSkge1xuICAgICAgZXhwYW5kQnRuLmNsYXNzTGlzdC5yZW1vdmUoJ3JvdGF0ZS1kb3duJyk7XG4gICAgICBleHBhbmRCdG4uY2xhc3NMaXN0LmFkZCgncm90YXRlLXVwJyk7XG5cbiAgICAgIGRpdi5jbGFzc0xpc3QucmVtb3ZlKCd0YXNrLWV4cGFuZCcpO1xuICAgICAgZGl2LmNsYXNzTGlzdC5hZGQoJ3Rhc2stcmVkdWNlJyk7XG5cbiAgICAgIHBEZXNjLmNsYXNzTGlzdC5yZW1vdmUoJ2Rlc2MtZXhwYW5kJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGV4cGFuZEJ0bi5jbGFzc0xpc3QuYWRkKCdyb3RhdGUtZG93bicpO1xuICAgICAgZGl2LmNsYXNzTGlzdC5hZGQoJ3Rhc2stZXhwYW5kJyk7XG4gICAgICBwRGVzYy5jbGFzc0xpc3QuYWRkKCdkZXNjLWV4cGFuZCcpO1xuICAgIH1cbiAgfSk7XG5cbiAgZWRpdEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICBlZGl0ID0gdHJ1ZTtcbiAgICB0YXNrRm9ybUNvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xuICAgIHRhc2tGb3JtLmRhdGFzZXQudGFza0luZGV4ID0gdGFza0luZGV4O1xuICAgIGZpbGxFZGl0Rm9ybShwVGl0bGUuaW5uZXJUZXh0LCBwRGVzYy5pbm5lclRleHQsIHBEdWVEYXRlLmlubmVyVGV4dCwgcFByaW9yaXR5LmlubmVyVGV4dCk7XG4gIH0pO1xuXG4gIGRlbGV0ZUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICBkZWxldGVUYXNrKGRpdiwgdGFzayk7XG4gIH0pXG5cbiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Rhc2stY29udGFpbmVyJykuYXBwZW5kQ2hpbGQoZGl2KTtcbiAgZGl2LmFwcGVuZChleHBhbmRCdG4sIGNoZWNrYm94LCBsYWJlbCwgcFRpdGxlLCBwRGVzYywgcER1ZURhdGUsIHBQcmlvcml0eSwgZWRpdEJ0biwgZGVsZXRlQnRuKTtcbn1cblxuZnVuY3Rpb24gY2xlYXJUYXNrKCkge1xuICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGFzay1jb250YWluZXInKTtcbiAgd2hpbGUoY29udGFpbmVyLmhhc0NoaWxkTm9kZXMoKSAmJiBjb250YWluZXIuY2hpbGRFbGVtZW50Q291bnQgPiAxKSB7XG4gICAgY29udGFpbmVyLnJlbW92ZUNoaWxkKGNvbnRhaW5lci5sYXN0Q2hpbGQpO1xuICB9XG59XG5cbmZ1bmN0aW9uIGZpbGxFZGl0Rm9ybSh0aXRsZSwgZGVzYywgZHVlZGF0ZSwgcHJpb3JpdHkpIHtcbiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RpdGxlJykudmFsdWUgPSB0aXRsZTtcbiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Rlc2MnKS52YWx1ZSA9IGRlc2M7XG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkdWUtZGF0ZScpLnZhbHVlID0gZHVlZGF0ZTtcbiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3ByaW9yaXR5JykudmFsdWUgPSBwcmlvcml0eTtcbn1cblxuZnVuY3Rpb24gZWRpdFRhc2socHJvamVjdEluZGV4LCB0YXNrSW5kZXgsIC4uLmZvcm1WYWx1ZXMpIHtcbiAgY29uc3QgZGl2ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgZGl2LnRhc2tbZGF0YS10YXNrLWluZGV4PVwiJHt0YXNrSW5kZXh9XCJdYCk7XG4gIGNvbnNvbGUubG9nKGRpdik7XG4gIGNvbnN0IG5vZGUgPSBkaXYuY2hpbGROb2RlcztcbiAgbGV0IGNvdW50ZXIgPSAzO1xuICBmb3IobGV0IGkgaW4gZm9ybVZhbHVlcykge1xuICAgIG5vZGVbY291bnRlcl0uaW5uZXJUZXh0ID0gZm9ybVZhbHVlc1tpXTtcbiAgICBhcnJQcm9qZWN0c1twcm9qZWN0SW5kZXhdLnRhc2tzW3Rhc2tJbmRleF1baV0gPSBmb3JtVmFsdWVzW2ldO1xuICAgIGNvdW50ZXIrK1xuICB9XG4gIHRhc2tGb3JtLnJlc2V0KCk7XG4gIHRhc2tGb3JtQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcbiAgZWRpdCA9IGZhbHNlO1xufVxuXG5mdW5jdGlvbiBkZWxldGVUYXNrKGRpdiwgdGFzaykge1xuICBsZXQgaW5kZXggPSBkaXYuZGF0YXNldC5wcm9qZWN0SW5kZXg7XG4gIGRpdi5yZW1vdmUoKTtcbiAgYXJyUHJvamVjdHNbaW5kZXhdLnJlbW92ZVRhc2sodGFzayk7XG4gIGNvbnN0IHRhc2tzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnRhc2snKTtcbiAgZm9yKGxldCBpIGluIGFyclByb2plY3RzW2luZGV4XS50YXNrcykge1xuICAgIHRhc2tzW2ldLmRhdGFzZXQudGFza0luZGV4ID0gaTtcbiAgfVxufVxuXG5jcmVhdGVQcm9qZWN0KFwiRGVmYXVsdFwiKTtcblxuZXhwb3J0IHsgY3JlYXRlUHJvamVjdCwgY3JlYXRlVGFzaywgZWRpdFRhc2ssIGVkaXQgfSIsImltcG9ydCB7IGNyZWF0ZVByb2plY3QsIGNyZWF0ZVRhc2ssIGVkaXRUYXNrLCBlZGl0IH0gZnJvbSBcIi4vRE9NXCI7XG5cbmNvbnN0IHByb2plY3RCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYWRkLXByb2plY3QtYnRuJyk7XG5jb25zdCBhZGRUYXNrQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FkZC10YXNrLWJ0bicpO1xuY29uc3QgdGFza0Zvcm0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGFzay1mb3JtJyk7XG5jb25zdCBwcm9qZWN0Rm9ybSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcm9qZWN0LWZvcm0nKTtcblxucHJvamVjdEZvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgKGUpID0+IHtcbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICBjcmVhdGVQcm9qZWN0KGUudGFyZ2V0WzBdLnZhbHVlKTtcbn0pO1xuXG5wcm9qZWN0QnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJvamVjdC1mb3JtLWNvbnRhaW5lcicpLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xufSk7XG5cbnRhc2tGb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIChlKSA9PiB7XG4gIGUucHJldmVudERlZmF1bHQoKTtcbiAgaWYoZWRpdCA9PT0gZmFsc2UpIHtcbiAgICBjcmVhdGVUYXNrKGUudGFyZ2V0LmRhdGFzZXQucHJvamVjdEluZGV4KTtcbiAgfSBlbHNlIGlmKGVkaXQgPT09IHRydWUpIHtcbiAgICBlZGl0VGFzayhlLnRhcmdldC5kYXRhc2V0LnByb2plY3RJbmRleCwgZS50YXJnZXQuZGF0YXNldC50YXNrSW5kZXgsIGUudGFyZ2V0WzBdLnZhbHVlLCBlLnRhcmdldFsxXS52YWx1ZSxcbiAgICAgIGUudGFyZ2V0WzJdLnZhbHVlLCBlLnRhcmdldFszXS52YWx1ZSk7XG4gIH1cbn0pO1xuXG5hZGRUYXNrQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICBjb25zdCBwcm9qZWN0cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIucHJvamVjdFwiKTtcbiAgaWYocHJvamVjdHMubGVuZ3RoID4gMCkge1xuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0YXNrLWZvcm0tY29udGFpbmVyJykuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gIH1cbn0pOyJdLCJuYW1lcyI6WyJhcnJQcm9qZWN0cyIsIlByb2plY3QiLCJjb25zdHJ1Y3RvciIsInRpdGxlIiwidGhpcyIsInRhc2tzIiwicmVtb3ZlUHJvamVjdCIsInNwbGljZSIsImluZGV4T2YiLCJhZGRUYXNrIiwidGFzayIsInB1c2giLCJyZW1vdmVUYXNrIiwiVGFzayIsImRlc2MiLCJkdWVkYXRlIiwicHJpb3JpdHkiLCJjb21wbGV0ZSIsImVkaXQiLCJwcm9qZWN0SGVhZGVyIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsInRhc2tGb3JtQ29udGFpbmVyIiwidGFza0Zvcm0iLCJjcmVhdGVQcm9qZWN0IiwicHJvamVjdE5hbWUiLCJjbGVhclRhc2siLCJkaXYiLCJjcmVhdGVFbGVtZW50IiwicCIsImVkaXRidG4iLCJkZWxldGVCdG4iLCJpbm5lclRleHQiLCJjbGFzc0xpc3QiLCJhZGQiLCJzZXRBdHRyaWJ1dGUiLCJsZW5ndGgiLCJkaXNhYmxlZCIsImFkZEV2ZW50TGlzdGVuZXIiLCJwcm9qZWN0SW5kZXgiLCJkYXRhc2V0IiwicHJvamVjdCIsImFwcGVuZFRhc2siLCJpbmRleCIsInJlbW92ZSIsInByb2plY3RUYXNrcyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJwcm9qZWN0cyIsImkiLCJkZWxldGVQcm9qZWN0IiwiaGFzQ2hpbGROb2RlcyIsInJlbW92ZUNoaWxkIiwibGFzdENoaWxkIiwiYXBwZW5kQ2hpbGQiLCJhcHBlbmQiLCJyZXNldCIsInN0eWxlIiwiZGlzcGxheSIsImNyZWF0ZVByb2plY3RDbGFzcyIsInRhc2tJbmRleCIsImV4cGFuZEJ0biIsImxhYmVsIiwiY2hlY2tib3giLCJwVGl0bGUiLCJwRGVzYyIsInBEdWVEYXRlIiwicFByaW9yaXR5IiwiZWRpdEJ0biIsInR5cGUiLCJjaGVja2VkIiwiY29udGFpbnMiLCJmaWxsRWRpdEZvcm0iLCJkZWxldGVUYXNrIiwiY29udGFpbmVyIiwiY2hpbGRFbGVtZW50Q291bnQiLCJ2YWx1ZSIsInByb2plY3RCdG4iLCJhZGRUYXNrQnRuIiwiZSIsInByZXZlbnREZWZhdWx0IiwidGFyZ2V0IiwidGl0bGVWYWx1ZSIsImRlc2NWYWx1ZSIsImR1ZURhdGVWYWx1ZSIsInByaW9yaXR5VmFsdWUiLCJjb2xvciIsIm51bSIsInNldFByaW9yaXR5Q29sb3IiLCJOdW1iZXIiLCJiYWNrZ3JvdW5kQ29sb3IiLCJjb25zb2xlIiwibG9nIiwiY3JlYXRlVGFza0NsYXNzIiwiY3JlYXRlVGFzayIsImZvcm1WYWx1ZXMiLCJxdWVyeVNlbGVjdG9yIiwibm9kZSIsImNoaWxkTm9kZXMiLCJjb3VudGVyIiwiZWRpdFRhc2siXSwic291cmNlUm9vdCI6IiJ9